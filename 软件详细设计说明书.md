# 软件详细设计说明书

> 《软件详细设计说明书》是对《软件概要设计说明书》的补充。
>
> 1. 本课程及本实验不涉及、不强调、不关注的部分可省略，但不允许删除已有条目。
> 2. 最终文档请删除所有灰色字体和斜体等说明部分。

[TOC]

## 1 引言

### 1.1 编写目的

**目的：**

1. **详细功能实现与设计方案**：进一步细化《软件概要设计》中提出的功能和架构，详细描述每个功能模块的设计思路、算法、数据结构以及接口设计等内容，为开发人员提供具体的开发指导。

2. **技术实现细节和规范**：深入讨论所选技术栈的具体使用方法和实现细节，包括各个模块之间的交互方式、数据传输格式、代码规范等，以确保开发人员在实现过程中遵循统一的规范和标准。

3. **系统流程和模块划分**：进一步明确系统的整体流程和各个模块之间的关联关系，有助于开发团队更好地理解系统的结构和工作流程，从而提高开发效率和代码质量。

4. **错误处理和异常情况处理**：考虑各种可能的错误和异常情况，并提出相应的处理方案，以确保系统在面对异常情况时能够正确处理，提高系统的稳定性和可靠性。

5. **数据存储和管理方案**：详细讨论数据的存储和管理方案，包括数据库设计、数据表结构设计以及数据访问方式等，以确保数据能够高效地存储和管理，并且能够满足系统的需求。

**预期读者：**

1. **项目开发成员**：开发团队成员需要深入了解系统的各个功能模块的设计和实现细节，以便于按照设计要求进行具体的编码和测试工作。

2. **项目测试成员**：测试团队需要根据详细设计说明书中系统的各个模块的设计和功能描述信息制定相应的测试方案，并进行系统功能测试、性能测试等工作。

3. **项目管理者**：项目管理者需要了解系统的详细设计方案，以便于对项目的进度和质量进行有效地管理和监控，确保项目能够按时按质完成。

4. **技术评审人员**：评审人员需要对系统的设计方案进行审查和评估，发现和解决潜在的技术风险和问题。

5. **甲方**：代表终端用户的实际需要和期望的人员，他们通常会提供反馈，以确保系统能够满足用户的需求和期望。

### 1.2 背景

**待开发软件系统的名称**： Imusic 音乐分享平台

**项目相关方**：

- **任务提出者**：软件工程基础课程组
- **开发者**：
  - 项目经理：尹耀
  - 团队开发成员：卢思文、薛惠天、牛梓涵、张旖霜
- **用户**： 使用音乐平台的用户，主要为广大音乐爱好者。
- **计算站（中心）**：软件将运行在阿里云服务器上，提供跨平台的访问，用户可以通过网页、移动应用等多种方式访问该音乐推荐平台，无论是在电脑、手机还是平板等设备上均可畅享音乐服务。

### 1.3 术语表

**1.Vue 3**

定义：Vue 3 是一个用于构建用户界面的渐进式JavaScript框架。第三版带来了性能改进、更快的编译时间
以及对 TypeScript 的更好支持。

原词组：不是首字母组词，直接指框架名。

**2.Django**

定义：Django 是一个高级Python Web框架，鼓励快速开发和干净、实用的设计。它处理了许多Web开发
的常见问题，因此开发者可以专注于编写应用程序而不是重新发明轮子。

原词组：不是首字母组词，而是以创建者之一的吉他手Django Reinhardt来命名。

**3.MySQL**

定义：MySQL 是一个开源的关系型数据库管理系统，基于SQL（结构化查询语言）。它是一种广泛使用的
数据库，适用于多种应用，包括Web应用。

原词组：不是首字母组词，"MySQL"是"My Structured Query Language"的简称，其中"My"来自创始人
Michael Widenius的女儿的名字。

**4.API**

定义：API 是一套规则、协议和工具，用于构建软件应用。它定义了应用程序之间如何相互通信以及数据的
交换格式。

原词组：Application Programming Interface

**5.UI**

定义：用户界面是软件的前端部分，用户通过它与软件进行交互。它包括屏幕布局、转换、界面动画以及声
音。

原词组：User Interface

**6.SQL**

定义：SQL 是用于访问和处理数据库的标准化查询语言。它可以用来执行各种操作，比如查询、更新和管理
数据库。

原词组：Structured Query Language

### 1.4 参考文档

1. 《软件需求规格说明书》
2. 《软件开发计划书》
3. 《接口设计文档》
4. 《软件概要设计说明书》

## 2 系统结构设计及子系统划分

本系统主要可以划分为以下子系统

### 2.1 用户子系统

#### 2.1.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/用户子系统/用户注册.png" alt="用户注册" title="用户注册" style="zoom: 33%;" />

<center>用户注册</center>

<img src="软件详细设计说明书.assets/活动图/用户子系统/用户登录.png" style="zoom: 33%;" />

<center>用户登录</center>

<img src="软件详细设计说明书.assets/活动图/用户子系统/用户查看和更新个人信息.png" style="zoom: 33%;" />

<center>用户查看和更新个人信息</center>

<img src="软件详细设计说明书.assets/活动图/用户子系统/用户关注和取消关注.png" style="zoom:33%;" />

<center>用户关注和取消关注</center>

#### 2.1.2 顺序图设计

### 2.2 歌单子系统

#### 2.2.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/歌单子系统/查看歌单.png" style="zoom:33%;" />

<center>查看歌单</center>

<img src="软件详细设计说明书.assets/活动图/歌单子系统/创建歌单.png" style="zoom:33%;" />

<center>创建歌单</center>

<img src="软件详细设计说明书.assets/活动图/歌单子系统/歌曲加入歌单.png" style="zoom:33%;" />

<center>歌曲加入歌单</center>

<img src="软件详细设计说明书.assets/活动图/歌单子系统/删除歌单.png" style="zoom:33%;" />

<center>删除歌单</center>

<img src="软件详细设计说明书.assets/活动图/歌单子系统/修改歌单.png" style="zoom:33%;" />

<center>修改歌单</center>

#### 2.2.2 顺序图设计

### 2.3 歌曲子系统

#### 2.3.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/歌曲子系统/查看歌曲.png" style="zoom:33%;" />

<center>查看歌曲</center>

<img src="软件详细设计说明书.assets/活动图/歌曲子系统/删除歌曲.png" style="zoom:33%;" />

<center>删除歌曲</center>

<img src="软件详细设计说明书.assets/活动图/歌曲子系统/上传歌曲.png" style="zoom:33%;" />

<center>上传歌曲</center>

<img src="软件详细设计说明书.assets/活动图/歌曲子系统/修改歌曲.png" style="zoom:33%;" />

<center>修改歌曲</center>

#### 2.3.2 顺序图设计

### 2.4 收藏子系统

#### 2.4.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/收藏子系统/收藏歌单.png" style="zoom:33%;" />

<center>收藏歌单</center>

<img src="软件详细设计说明书.assets/活动图/收藏子系统/添加喜欢的歌曲.png" style="zoom:33%;" />

<center>添加喜欢的歌曲</center>

<img src="软件详细设计说明书.assets/活动图/收藏子系统/取消收藏歌单.png" style="zoom:33%;" />

<center>取消收藏歌单</center>

<img src="软件详细设计说明书.assets/活动图/收藏子系统/取消喜欢的歌曲.png" style="zoom:33%;" />

<center>取消喜欢的歌曲</center>

#### 2.4.2 顺序图设计

### 2.5 消息子系统

#### 2.5.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/消息子系统/更新消息.png" style="zoom:33%;" />

<center>更新消息</center>

<img src="软件详细设计说明书.assets/活动图/消息子系统/关注消息.png" style="zoom:33%;" />

<center>关注消息</center>

<img src="软件详细设计说明书.assets/活动图/消息子系统/评论消息.png" style="zoom:33%;" />

<center>评论消息</center>

<img src="软件详细设计说明书.assets/活动图/消息子系统/上传消息.png" style="zoom:33%;" />

<center>上传消息</center>

<img src="软件详细设计说明书.assets/活动图/消息子系统/听歌周报和创作周报.png" style="zoom:33%;" />

<center>听歌周报和创作周报</center>

#### 2.5.2 顺序图设计

### 2.6 评论子系统

#### 2.6.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/评论子系统/查看评论.png" style="zoom:33%;" />

<center>查看评论</center>

<img src="软件详细设计说明书.assets/活动图/评论子系统/添加评论.png" style="zoom:33%;" />

<center>添加评论</center>

#### 2.6.2 顺序图设计

### 2.7 审核子系统

#### 2.7.1 活动图设计

<img src="软件详细设计说明书.assets/活动图/审核子系统/投诉歌曲或歌单.png" style="zoom:33%;" />

<center>投诉歌曲或歌单</center>

<img src="软件详细设计说明书.assets/活动图/审核子系统/申诉.png" style="zoom:33%;" />

<center>申诉</center>

<img src="软件详细设计说明书.assets/活动图/审核子系统/查看投诉信息.png" style="zoom:33%;" />

<center>查看投诉消息</center>

<img src="软件详细设计说明书.assets/活动图/审核子系统/查看申诉消息.png" style="zoom:33%;" />

<center>查看申诉消息</center>

<img src="软件详细设计说明书.assets/活动图/审核子系统/处理投诉信息.png" style="zoom:33%;" />

<center>处理投诉消息</center>

<img src="软件详细设计说明书.assets/活动图/审核子系统/处理申诉信息.png" style="zoom:33%;" />

<center>处理申诉消息</center>

#### 2.7.2 顺序图设计

## 3 功能模块设计


### 101 用户注册模块

- 输入：

    - 用户名 (username) - 必填
    - 密码 (password) - 必填
    - 电子邮箱 (email) - 必填
    - 验证码 (verification_code) - 必填
    - 简介 (bio)：用户的简介或描述 - 可选
    - 头像 (avatar)：用户头像[文件] - 可选

- 处理：

    - 调用验证码发送功能，判断必填项是否全部填写，保存用户信息至数据库，向用户返回注册信息。

- 算法描述：

  ![用户注册](软件详细设计说明书.assets/用户注册.png)

- 输出：

    - 若注册成功，跳转至登录界面；若注册不成功，返回提示帮助用户完成注册。

### 102 用户登录模块

- 输入：

    - 用户名 (username) - 必填
    - 密码 (password) - 必填

- 处理：

    - 判断用户名和密码是否和数据库匹配，向用户返回登录信息。

- 算法描述：

  ![用户登录](软件详细设计说明书.assets/用户登录.png)

- 输出：

    - 若登录成功，跳转至主界面；若登录不成功，返回提示帮助用户完成登录。

### 103 用户信息修改模块

- 输入：

    - 用户名 (username) - 必填
    - 密码 (password) - 必填

- 处理：

    - 将用户信息更新至数据库，向用户返回更新信息。

- 算法描述：

  ![用户查看和更新个人信息](./软件详细设计说明书.assets/用户查看和更新个人信息.png)

- 输出：

    - 若更新成功，向用户返回更新成功信息；若更新不成功，返回提示帮助用户完成更新信息。

### 104 用户关注和取消关注模块

- 输入

    - 用户点击关注/取消关注按钮。

- 处理

    - 发送关注/取消关注请求，更新数据库中关注列表。

- 算法描述

  ![用户关注和取消关注](./软件详细设计说明书.assets/用户关注和取消关注.png)

- 输出

    - 向用户输出关注成功信息。

### 201 播放歌曲模块

- 输入：

    - 用户点击目标歌曲播放按钮。

- 处理：

    - 获取歌曲id，在数据库中寻找歌曲详细信息，向用户展示歌曲详细信息。

- 算法描述：

  ![查看歌曲](./软件详细设计说明书.assets/查看歌曲.png)

- 输出：

    - 播放歌曲，向用户展示歌曲详细信息。

### 202 上传歌曲模块

- 输入：

    - 标题 (title)
    - 演唱者 (singer)
    - 封面图 (cover)
    - 介绍 (introduction)
    - 音频文件 (audio)
    - 歌词文件 (lyric，可选)
    - 主题标签 (tag_theme，可为空)
    - 场景标签 (tag_scene，可为空)
    - 心情标签 (tag_mood，可为空)
    - 风格标签 (tag_style，可为空)
    - 语言标签 (tag_language，可为空)

- 处理：

    - 判断必填项是否全部填写，保存歌曲信息至数据库，向用户返回上传信息。

- 算法描述：

  ![上传歌曲](./软件详细设计说明书.assets/上传歌曲.png)

- 输出：

    - 若上传成功，存储歌曲至数据库，向用户返回上传成功信息；否则返回提示帮助用户完成上传。

### 203 修改歌曲模块

- 输入：

    - 标题 (title，可选)
    - 演唱者 (singer，可选)
    - 封面图 (cover，可选)
    - 介绍 (introduction，可选)
    - 音频文件 (audio)
    - 歌词文件 (lyric，可选)
    - 主题标签 (tag_theme，可为空)
    - 场景标签 (tag_scene，可为空)
    - 心情标签 (tag_mood，可为空)
    - 风格标签 (tag_style，可为空)
    - 语言标签 (tag_language，可为空)

- 处理：

    - 获取歌曲id，判断输入信息合法性，修改数据库中歌曲。

- 算法描述：

  ![修改歌曲](./软件详细设计说明书.assets/修改歌曲.png)

- 输出：

    - 若更新成功，更新歌曲至数据库，向用户返回更新成功信息；否则返回提示帮助用户完成更新。

### 204 删除歌曲模块

- 输入：

    - 用户点击删除歌曲按钮。

- 处理：

    - 删除数据库中歌曲，向用户返回删除信息。

- 算法描述：

  ![删除歌曲](./软件详细设计说明书.assets/删除歌曲.png)

- 输出：

    - 向用户返回删除成功信息。

### 301 创建歌单模块

- 输入：

    - 标题 (title) - 必填
    - 封面图(cover) - 必填
    - 介绍(introduction)
    - 标签（可为空）
    - 主题标签(tag_theme)
    - 场景标签(tag_scene)
    - 心情标签(tag_mood)
    - 风格标签(tag_style)
    - 语言标签(tag_language)

- 处理：

    - 判断输入信息的合法性，保存歌单信息至数据库，向用户返回创建信息。

- 算法描述：

  ![创建歌单](./软件详细设计说明书.assets/创建歌单.png)

- 输出：

    - 若创建成功，存储歌单至数据库，向用户返回创建成功信息；否则返回提示帮助用户完成创建。

### 302 查看歌单模块

- 输入：

    - 用户点击查看歌单信息按钮。

- 处理：

    - 发送歌单id，在数据库中查看歌单信息，向用户展示歌单信息。

- 算法描述：

  ![查看歌单](./软件详细设计说明书.assets/查看歌单.png)

- 输出：

    - 向用户展示歌单信息。

### 303 修改歌单模块

- 输入：

    - 标题 (title，可选)
    - 封面图(cover，可选)
    - 介绍(introduction，可选)
    - 标签（可为空）
    - 主题标签(tag_theme)
    - 场景标签(tag_scene)
    - 心情标签(tag_mood)
    - 风格标签(tag_style)
    - 语言标签(tag_language)

- 处理：

    - 获取歌单id，判断输入信息合法性，修改数据库中歌单。

- 算法描述：

  ![修改歌曲](./软件详细设计说明书.assets/修改歌曲.png)

- 输出：

    - 若修改成功，修改歌单至数据库，向用户返回修改成功信息；否则返回提示帮助用户完成修改。

### 304 删除歌单模块

- 输入
    - 用户点击删除歌单按钮。

- 处理

    - 获取歌单id，删除数据库中歌单。

- 算法描述：

  ![删除歌单](./软件详细设计说明书.assets/删除歌单.png)

- 输出：

    - 删除数据库中对应歌单，向用户返回删除成功信息。

### 305 添加歌曲至歌单模块

- 输入
    - 用户选择歌曲和想加入的歌单。

- 处理

    - 获取歌单id和歌单id，将歌曲id保存至歌单中。

- 算法描述：

  ![歌曲加入歌单](./软件详细设计说明书.assets/歌曲加入歌单.png)

- 输出：

    - 更新数据库中歌单信息，向用户返回添加成功信息。

### 401 收藏歌单模块

- 输入
    - 用户选择想收藏的歌单。

- 处理

    - 获取歌单id，将歌单id保存至用户收藏夹。

- 算法描述：

  ![收藏歌单](./软件详细设计说明书.assets/收藏歌单.png)

- 输出：

    - 更新数据库中收藏夹信息，向用户返回收藏成功信息。

### 402 取消收藏歌单模块

- 输入
    - 用户选择想取消收藏的歌单。

- 处理

    - 获取歌单id，删除收藏夹中对应的用户歌单。

- 算法描述：

  ![取消收藏歌单](./软件详细设计说明书.assets/取消收藏歌单.png)

- 输出：

    - 更新数据库中收藏夹信息，向用户返回删除成功信息。

### 403 添加喜欢的歌曲模块

- 输入
    - 用户选择想添加至喜欢的歌曲。

- 处理

    - 获取歌曲id，将歌曲id保存至用户喜欢的歌曲列表。

- 算法描述：

  ![添加喜欢的歌曲](./软件详细设计说明书.assets/添加喜欢的歌曲.png)

- 输出：

    - 更新数据库中喜欢歌曲列表信息，向用户返回添加成功信息。

### 404 取消喜欢的歌曲模块

- 输入
    - 用户选择想取消喜欢的歌曲。

- 处理

    - 获取歌曲id，删除喜欢歌曲列表中对应的歌曲。

- 算法描述：

  ![取消喜欢的歌曲](./软件详细设计说明书.assets/取消喜欢的歌曲.png)

- 输出：

    - 更新数据库中喜欢歌曲列表信息，向用户返回取消喜欢成功信息。

### 501 关注信息模块

- 输入
    - 用户选择想关注的用户。

- 处理

    - 获取被关注者用户名，调用用户关注模块，添加关注。创建关注信息，保存关注信息至数据库，向被关注者展示新的被关注信息，向用户展示关注成功信息。

- 算法描述：

  ![关注消息](./软件详细设计说明书.assets/关注消息.png)

- 输出：

    - 向被关注者展示新的被关注信息，向用户展示关注成功信息。

### 502 更新信息模块

- 输入
    - 用户更新歌曲/歌单信息。

- 处理

    - 根据更新内容创建更新消息，将更新消息保存至数据库，在关注者的消息页面展示更新消息。

- 算法描述：

  ![更新消息](./软件详细设计说明书.assets/更新消息.png)

- 输出：

    - 在关注者的消息页面展示更新消息。

### 503 上传信息模块

- 输入
    - 用户上传歌曲/创建歌单。

- 处理

    - 根据上传内容创建上传消息，将上传消息保存至数据库，在关注者的消息页面展示上传消息。

- 算法描述：

  ![上传消息](./软件详细设计说明书.assets/上传消息.png)

- 输出：

    - 在关注者的消息页面展示上传消息。

### 504 听歌周报和创作周报模块

- 输入
    - 无输入，定时开启模块。

- 处理

    - 根据用户历史信息创建听歌周报和创作周报，将周报保存至数据库，在用户的消息页面展示听歌周报和创作周报。

- 算法描述：

  ![听歌周报和创作周报](./软件详细设计说明书.assets/听歌周报和创作周报.png)

- 输出：

    - 在用户的消息页面展示听歌周报和创作周报。

### 505 评论消息模块

- 输入
    - 用户创建评论。

- 处理

    - 根据评论创建评论消息，将评论消息保存至数据库，在上传者的消息页面展示评论消息。

- 算法描述：

  ![评论消息](./软件详细设计说明书.assets/评论消息.png)

- 输出：

    - 在上传者的消息页面展示评论消息。

### 601 投诉歌曲或歌单模块

- 输入
    - 用户选择投诉歌曲或歌单。

- 处理

    - 根据投诉内容创建投诉信息和投诉通知信息，在被投诉者和管理员的消息界面展示投诉通知信息，向用户返回投诉结果。

- 算法描述：

  ![投诉歌曲或歌单](./软件详细设计说明书.assets/投诉歌曲或歌单.png)

- 输出：

    - 在被投诉者和管理员的消息界面展示投诉通知信息，向用户返回投诉结果。

### 602 申诉模块

- 输入
    - 用户选择申诉。

- 处理

    - 根据申诉内容创建申诉信息，在管理员的消息界面展示申诉信息，向用户返回申诉结果。

- 算法描述：

  ![申诉](./软件详细设计说明书.assets/申诉.png)

- 输出：

    - 在管理员的消息界面展示申诉信息，向用户返回申诉结果。

### 603 查看和处理投诉信息模块

- 输入
    - 管理员选择查看投诉记录。

- 处理

    - 管理员查看投诉记录，对投诉信息进行处理，创建投诉处理结果信息，向被投诉者和投诉者发送投诉处理结果信息，向管理员返回处理成功结果。

- 算法描述：

  ![查看和处理投诉消息](./软件详细设计说明书.assets/查看和处理投诉消息.png)

- 输出：

    - 向被投诉者和投诉者发送投诉处理结果信息，向管理员返回处理成功结果。

### 604 查看和处理申诉信息模块

- 输入
    - 管理员选择查看申诉记录。

- 处理

    - 管理员查看申诉记录，对申诉信息进行处理，创建申诉处理结果信息，向被投诉者发送申诉处理结果信息，向管理员返回处理成功结果。

- 算法描述：

  ![查看和处理申诉消息](./软件详细设计说明书.assets/查看和处理申诉消息.png)

- 输出：

    - 向被投诉者发送申诉处理结果信息，向管理员返回处理成功结果。

### 701 添加评论模块

- 输入
    - 用户填写评论内容，选择上传评论。

- 处理

    - 用户请求上传评论，验证系统判断输入评论的合法性，若合法，保存评论并向用户返回评论成功信息；若不合法，向用户返回错误信息。

- 算法描述：

  ![添加评论](./软件详细设计说明书.assets/添加评论.png)

- 输出：

    - 若评论合法，保存评论并向用户返回评论成功信息；若评论不合法，向用户返回错误信息。

### 702 查看评论模块

- 输入
    - 用户选择查看歌曲评论。

- 处理

    - 用户请求查看歌曲评论，根据歌曲id获得数据库中评论信息，在用户评论界面展示评论。

- 算法描述：

  ![查看评论](./软件详细设计说明书.assets/查看评论.png)

- 输出：

    - 在用户评论界面展示评论。

### 703 删除评论模块

- 输入
    - 用户选择删除评论。

- 处理

    - 用户请求删除评论，验证系统判断用户删除权限，若删除成功，向用户返回删除结果并在评论界面更新评论；若不成功，向用户返回错误信息。

- 算法描述：

  ![删除评论](./软件详细设计说明书.assets/删除评论.png)

- 输出：

    - 若删除成功，向用户返回删除结果并在评论界面更新评论；若不成功，向用户返回错误信息。


## 4 界面设计

### 4.1 外部界面设计

1. **用户注册**

   - 请求类型：POST
   - URL：/users/register
   - 请求参数：
     - 用户名 (username) - 必填
     - 密码 (password) - 必填
     - 电子邮箱 (email) - 必填
     - 验证码 (verification_code) - 必填
     - 简介 (bio)：用户的简介或描述 - 可选
     - 头像 (avatar)：用户头像[文件] - 可选
   - 返回结果：
     - 是否成功 (success)：表示注册是否成功
     - 消息 (message)：注册过程的结果消息

2. **发送验证码**

   - 请求类型：POST
   - URL：/users/send-code
   - 请求参数：
     - 电子邮箱 (email) - 必填且有效
   - 返回结果：
     - 是否成功 (success)：表示注册是否成功
     - 消息 (message)：注册过程的结果消息

3. **用户登录**

   - 请求类型：POST
   - URL：/users/login
   - 请求参数：
     - 用户名 (username) - 必填
     - 密码 (password) - 必填
   - 返回结果：
     - 是否成功 (success)：表示登录是否成功
     - 消息 (message)：登录过程的结果消息
     - 用户信息 (user)：包括用户ID、用户名、角色等

4. **获取用户信息**

   - 请求类型：GET
   - URL：/users/info/{username}
   - 请求参数：
     - 用户名 (username) - 必填
   - 返回结果：
     - 用户ID (user_id)
     - 用户名 (username)
     - 电子邮箱 (email)
     - 注册时间 (registration_date)
     - 简介 (bio)：用户的简介或描述
     - 头像 (avatar)：用户头像的URL

5. **更新用户信息**

   - 请求类型：POST
   - URL：/users/update/{username}
   - 请求参数：
     - 用户名 (username) - 必填
     - 更新后的用户信息 (Updateduser)：包括电子邮箱、简介、头像 - 选填
   - 返回结果：
     - 是否成功 (success)：表示更新是否成功
     - 消息 (message)：更新过程的结果消息

6. **更改用户权限**

   - 请求类型：POST
   - URL：/users/change-role
   - 请求参数：
     - 要修改权限的用户(dir_user) - 必填
     - 要修改成的角色(role) - 必填
     - 授权密钥(key) - 可选
   - 返回结果：
     - 是否成功 (success)：表示更新是否成功
     - 消息 (message)：更新过程的结果消息

7. **修改密码**

   - 请求类型：POST
   - URL：/users/change-pwd
   - 请求参数：
     - 修改后的密码(new_password) - 必填
   - 返回结果：
     - 是否成功 (success)：表示修改是否成功
     - 消息 (message)：修改过程的结果消息

8. **获取用户创建的所有歌单**

   - 请求类型：GET
   - URL：/users/songlists
   - 请求参数：
     - 用户姓名 (username) - 必填
   - 返回结果：
     - 是否成功 (success)：表示获取是否成功
     - 返回用户创建的所有歌单

9. **获取用户上传的所有歌曲**

   - 请求类型：GET
   - URL：/users/songs
   - 请求参数：
     - 用户姓名 (username) - 必填
   - 返回结果：
     - 是否成功 (success)：表示获取是否成功
     - data：返回用户上传的所有歌曲

10. **获取用户关注列表**

    - 请求类型：GET
    - URL：/users/followings
    - 请求参数：
      - 被查看关注列表的用户名（username） - 必填
    - 返回结果：
      - 是否成功(success)
      - 返回信息(message)
      - 数据(data)

11. **获取用户关注者列表**

    - 请求类型：GET
    - URL：/users/followers
    - 请求参数：
      - 被查看关注者列表的用户名（username） - 必填
    - 返回结果：
      - 是否成功(success)
      - 返回信息(message)
      - 数据(data)

12. 上传歌曲接口：

    - **请求类型：** POST
    - **URL：** `/songs/upload`
    - 请求参数：
      - 标题 (title)
      - 演唱者 (singer)
      - 封面图 (cover)
      - 介绍 (introduction)
      - 音频文件 (audio)
      - 歌词文件 (lyric，可选)
      - 主题标签 (tag_theme，可为空)
      - 场景标签 (tag_scene，可为空)
      - 心情标签 (tag_mood，可为空)
      - 风格标签 (tag_style，可为空)
      - 语言标签 (tag_language，可为空)
      - 上传者 (uploader，是 username)
      - 喜欢人数 (like，默认为0)
    - 返回结果：
      - 歌曲上传成功
      - 错误信息 (message)
        - 缺少字段
        - 缺少文件
        - 上传重复歌曲
        - 上传了非MP3格式文件
        - 文件大小超过限制
      - 其他异常信息

13. 获取歌曲信息接口：

    - **请求类型：** GET
    - **URL：** `/songs/info/{songID}`
    - 请求参数：
      - 歌曲ID (songID)
      - 用户名 (username，选填)
    - 返回结果：
      - 歌曲信息字典 (data)
      - 获取成功消息
      - 找不到歌曲消息

14. 获取歌曲信息（条件查询）接口：

    - **请求类型：** GET
    - **URL：** `/songs/query?key1=value1&key2=value2`
    - 返回结果：
      - 字典组成的列表 (data)
      - 搜索成功消息
      - 缺少搜索关键字消息
      - 其他异常信息

15. 更新歌曲信息接口：

    - **请求类型：** POST
    - **URL：** `/songs/update/{songID}`
    - 请求参数：
      - 歌曲ID (songID)
      - 标题 (title，可选)
      - 演唱者 (singer，可选)
      - 封面图 (cover，可选)
      - 介绍 (introduction，可选)
      - 音频文件 (audio，可选)
      - 歌词文件 (lyric，可选)
      - 主题标签 (tag_theme，可选)
      - 场景标签 (tag_scene，可选)
      - 心情标签 (tag_mood，可选)
      - 风格标签 (tag_style，可选)
      - 语言标签 (tag_language，可选)
    - 返回结果：
      - 更新是否成功 (success)
      - 更新结果消息 (message)

16. 删除歌曲接口：

    - **请求类型：** DELETE
    - **URL：** `/songs/delete/{songID}`
    - 请求参数：
      - 歌曲ID (songID)
    - 返回结果：
      - 删除是否成功 (success)
      - 删除结果消息 (message)

17. 查看歌曲评论接口：

    - **请求类型：** GET
    - **URL：** `/songs/comments`
    - 请求参数：
      - 歌曲ID (songID)
    - 返回结果：
      - 是否成功 (success)
      - 返回信息 (message)
      - 返回数据 (data)

18. 创建歌单

    - **请求类型：** POST
    - **URL：** /songlists/create
    - 请求参数：
      - 标题 (title) - 必填
      - 封面图(cover) - 必填
      - 介绍(introduction)
      - 标签（可为空）
        - 主题标签(tag_theme)
        - 场景标签(tag_scene)
        - 心情标签(tag_mood)
        - 风格标签(tag_style)
        - 语言标签(tag_language)
      - 所有者/创建者(owner) - 必填
    - 返回结果：
      - 是否成功 (success)
      - 消息 (message)

19. 获取歌单信息

    - **请求类型：** GET
    - **URL：** /songlists/info/{songlistID}
    - 请求参数：
      - 歌单ID (SonglistID) - 必填
      - 用户名(username) - 选填，用于查询对应用户是否喜欢该歌单
    - 返回结果：
      - 标题 (title)
      - 封面图(文件地址，cover_url)
      - 介绍(introduction)
      - 包含的歌曲(歌曲列表)
      - 标签（获取的结果可能为空）
        - 主题标签(tag_theme)
        - 场景标签(tag_scene)
        - 心情标签(tag_mood)
        - 风格标签(tag_style)
        - 语言标签(tag_language)
      - 所有者/创建者(owner, 是username)
      - 创建时间(create_date)
      - 喜欢人数(like)

20. 更新歌单信息

    - **请求类型：** POST
    - **URL：** /songlists/update/{songlistID}
    - 请求参数：
      - 歌单ID (SonglistID) - 必填
      - 标题 (title)
      - 封面图(cover)
      - 介绍(introduction)
      - 包含的歌曲(Songs)
      - 标签（可更新为空）
        - 主题标签(tag_theme)
        - 场景标签(tag_scene)
        - 心情标签(tag_mood)
        - 风格标签(tag_style)
        - 语言标签(tag_language)
    - 返回结果：
      - 是否成功 (success)
      - 消息 (message)

21. 删除歌单

    - **请求类型：** DELETE
    - **URL：** /songlists/delete/{songlistID}
    - 请求参数：
      - 歌单ID (SonglistID) - 必填
    - 返回结果：
      - 是否成功 (success)
      - 消息 (message)

22. 向歌单添加歌曲

    - **请求类型：** POST
    - **URL：** /songlists/addsong
    - 请求参数：
      - 歌单ID (songlist_id) - 必填
      - 歌曲ID (song_id) - 必填
    - 返回结果：
      - 是否成功 (success)
      - 消息 (message)

23. 从歌单删除歌曲

    - **请求类型：** POST
    - **URL：** /songlists/delsong
    - 请求参数：
      - 歌单ID (songlist_id) - 必填
      - 歌曲ID (song_id) - 必填
    - 返回结果：
      - 是否成功 (success)
      - 消息 (message)

24. 搜索歌曲

    - **功能：** 根据关键字搜索歌曲。
    - **URL：** `/search/songs`
    - **请求方法：** GET
    - 请求参数：
      - `keyword` (可选)：搜索关键字
      - `tag_scene` (可选)：场景标签
      - `num` (可选)：返回的歌曲数量，默认为所有
    - 返回结果：
      - 字典组成的列表，表示歌曲集合
      - 如果不添加任何查询参数，默认返回所有歌曲；也可以使用 `keyword` 或 `tag_scene` 参数进行搜索，以及使用 `num` 参数指定返回数量
      - 模糊查询
    - 返回信息：
      - 搜索成功
      - 捕获到的异常

25. 搜索歌单

    - **功能：** 根据关键字搜索歌单。
    - **URL：** `/search/songlists`
    - **请求方法：** GET
    - 请求参数：
      - `keyword` (可选)：搜索关键字
      - `num` (可选)：返回的歌单数量，默认为所有
    - 返回结果：
      - 字典组成的列表，表示歌单集合
      - 如果不添加任何查询参数，默认返回所有歌单；也可以使用 `keyword` 参数进行搜索，以及使用 `num` 参数指定返回数量
      - 模糊查询
    - 返回信息：
      - 搜索成功
      - 捕获到的异常

26.  搜索用户

    - **功能：** 根据关键字搜索用户。
    - **URL：** `/search/users`
    - **请求方法：** GET
    - 请求参数：
      - `keyword` (可选)：搜索关键字
      - `num` (可选)：返回的用户数量，默认为所有
    - 返回结果：
      - 字典组成的列表，表示用户集合
      - 如果不添加任何查询参数，默认返回所有用户；也可以使用 `keyword` 参数进行搜索，以及使用 `num` 参数指定返回数量
      - 模糊查询
    - 返回信息：
      - 搜索成功
      - 捕获到的异常

27. 获取最近上传的歌曲

    - **功能：** 获取最近上传的歌曲列表。

    - **URL：** `/recommend/latest`

    - **请求方法：** GET

    - 请求参数：

      - `num` (可选)：需要获取的最近歌曲数量，默认为15

    - 返回结果：

      - `success`：表示是否成功获取

      - `message`：结果消息

      - ```
        data
        ```

        ：最近上传的歌曲列表

        - `id`：歌曲ID
        - `title`：歌曲标题
        - `singer`：歌手
        - `cover`：封面链接
        - `duration`：时长
        - `uploader`：上传者
        - `like`：点赞数
        - `upload_date`：上传日期

28. 根据用户喜好获取推荐歌曲

    - **功能：** 根据用户喜好获取推荐的歌曲列表。
    - **URL：** `/recommend`
    - **请求方法：** GET
    - **请求参数：** 无
    - 返回结果：
      - `success`：表示是否成功获取
      - `message`：结果消息
      - `data`推荐歌曲列表

29. 获取用户喜爱歌曲

    - **功能：** 获取用户喜爱的歌曲列表。
    - **URL：** `/like/songs`
    - **请求方法：** GET
    - 请求参数：
      - `username`：用户名
    - 返回结果：
      - `success`：表示是否成功获取
      - `message`：结果消息
      - `data`：用户喜爱的歌曲列表

30. 用户添加喜爱歌曲

    - **功能：** 将歌曲添加到用户喜爱列表。
    - **URL：** `/like/songs/add`
    - **请求方法：** POST
    - 请求参数：
      - `song_id`：歌曲ID
    - 返回结果：
      - `success`：表示是否成功添加
      - `message`：结果消息

31. 用户删除喜爱歌曲

    - **功能：** 从用户喜爱列表中删除歌曲。
    - **URL：** `/like/songs/delete`
    - **请求方法：** POST
    - 请求参数：
      - `song_id`：歌曲ID
    - 返回结果：
      - `success`：表示是否成功删除
      - `message`：结果消息

32. 获取用户喜爱歌单

    - **功能：** 获取用户喜爱的歌单列表。
    - **URL：** `/like/songlists`
    - **请求方法：** GET
    - 请求参数：
      - `username`：用户名
    - 返回结果：
      - `success`：表示是否成功获取
      - `data`：用户喜爱的歌单列表

33. 用户添加喜爱歌单

    - **功能：** 将歌单添加到用户喜爱列表。
    - **URL：** `/like/songlists/add`
    - **请求方法：** POST
    - 请求参数：
      - `songlist_id`：歌单ID
    - 返回结果：
      - `success`：表示是否成功添加
      - `message`：结果消息

34. 用户删除喜爱歌单

    - **功能：** 从用户喜爱列表中删除歌单。
    - **URL：** `/like/songlists/delete`
    - **请求方法：** POST
    - 请求参数：
      - `songlist_id`：歌单ID
    - 返回结果：
      - `success`：表示是否成功删除
      - `message`：结果消息

35. 加关注/取消关注

    - **请求类型：** POST
    - **URL：** `/users/follow`
    - 请求参数：
      - `username`：被关注/取消关注用户姓名
    - 返回结果：
      - `success`：加关注/取消关注是否成功
      - `message`：加关注成功/取消关注成功
    - 补充：
      - 加关注/取消关注会对应处理Message表：
        - 加关注：创建一条信息，内容为“x关注了你”，其中x会被替换为发起请求的用户；类型为4
        - 取消关注：删除加关注时创建的那条信息
      - 加关注/取消关注会对应处理User的following_count（正在关注的人数）字段和follower_count（正在关注ta的人数）字段：
        - 加关注：发起请求的用户的following_count += 1，被关注的用户的follower_count += 1
        - 取消关注：发起请求的用户的following_count -= 1，被关注的用户的follower_count -= 1

36. 发表评论

    - 请求类型： POST
    - URL： /comments/add
    - 请求参数：
      - 歌曲ID (songID)
      - 评论内容(content)
    - 返回结果：
      - 是否成功 (success)：表示删除是否成功
      - 消息 (message)：删除过程的结果消息

37. 删除评论

    - 请求类型： DELETE
    - URL： /comments/delete
    - 请求参数：
      - 评论id(contentID)
    - 返回结果：
      - 是否成功 (success)：表示删除是否成功
      - 消息 (message)：删除过程的结果消息

38. 获取用户消息

    - 请求类型： GET
    - URL： /messages
    - 请求参数：
      - 无
    - 返回结果：
      - 是否成功 (success)：表示获取消息是否成功
      - 消息 (message)：获取过程的结果消息

39. 已读消息

    - 请求类型： GET
    - URL： /messages/read
    - 请求参数：
      - 消息ID (message_id) 必填
    - 返回结果：
      - 是否成功 (success)：表示读消息是否成功
      - 消息 (message)：过程的结果消息

40. 发送消息

    - 请求类型： POST
    - URL： /messages/send
    - 请求参数：
      - 接收方 (receiver) 必填 为用户名
      - 消息内容 (content) 必填 不为空
    - 返回结果：
      - 是否成功 (success)：表示发送消息是否成功
      - 消息 (message)：发送过程的结果消息

41. 删除消息

    - 请求类型： DELETE
    - URL： /messages/delete
    - 请求参数：
      - 消息ID (message_id) 必填
    - 返回结果：
      - 是否成功 (success)：表示删除消息是否成功
      - 消息 (message)：删除过程的结果消息

42. 获取用户最近播放

    - 请求类型： GET
    - URL： feature/recent
    - 请求参数：
      - 返回的歌曲数量(num) 可选 默认为10首，如果是-1则返回所有播放记录
    - 返回结果：
      - 是否成功 (success)：表示获取是否成功
      - 消息 (message)：结果消息
      - 返回用户播放列表，按照最近播放时间先后排序
      - 返回参数中的last_play是最近播放时间，play_count是播放次数

43. 添加最近播放歌曲

    - 请求类型： POST
    - URL： feature/addrecent
    - 请求参数：
      - 歌曲id(song_id）必填
    - 返回结果：
      - 是否成功 (success)：表示添加是否成功
      - 消息 (message)：添加过程的结果消息

44. 删除最近播放歌曲

    - 请求类型： DELETE
    - URL： feature/delrecent
    - 请求参数：
      - 歌曲id(song_id) 必填
    - 返回结果：
      - 是否成功 (success)：表示删除是否成功
      - 消息 (message)：删除过程的结果消息

45. 热门歌单

    - 请求类型： GET
    - URL： feature/hotsonglists
    - 请求参数：
      - 需要的数量(num) 可选，默认为10首
    - 返回结果：
      - 是否成功 (success)：表示获取是否成功
      - 消息 (message)：获取过程的结果消息
      - 返回喜欢数量排名前十的歌单

46. 热门歌曲

    - 请求类型： GET
    - URL： feature/hotsongs
    - 请求参数：
      - 需要的数量(num) 可选，默认为10首
    - 返回结果：
      - 是否成功 (success)：表示获取是否成功
      - 消息 (message)：获取过程的结果消息
      - 返回喜欢数量排名前十的歌曲

### 4.2 内部界面设计

**根组件调用（Home）：**

Home中包含左侧的侧栏模块以及右侧的主要界面模块。

1. **Warning.vue**
   - Props:
     - `message`: 警告消息。
     - `Warningshow`: 控制警告框是否显示。
   - Events:
     - `CloseWarning`: 关闭警告框的方法。
2. **SideBar.vue**
   - Props:
     - `HasLogin`: 用户是否登录的状态。
     - `avatar`: 用户头像。
     - `mode`: 当前页面模式。
     - `username`: 用户名。
     - `userdata`: 用户数据。
     - `createdSonglists`: 用户创建的歌单列表。
     - `favoriteSonglists`: 用户收藏的歌单列表。
     - `currentUserSongList`: 当前用户的歌单列表。
     - `userUploadedSongs`: 用户上传的歌曲列表。
     - `showUserSongList`: 控制是否显示用户的歌单。
     - `UserRole`: 用户角色。
   - Events:
     - `checkLogin`: 检查用户是否登录的方法。
3. **Login.vue**
   - Props:
     - `username`: 用户名。
     - `HasLogin`: 用户是否登录的状态。
     - `avatar`: 用户头像。
     - `token`: 用于授权的令牌。
     - `UserRole`: 用户角色。
   - Events:
     - `changeMode`: 改变页面模式的方法。
     - `ChangerRegisterMode`: 切换注册模式的方法。
     - `getsonglistinit`: 获取歌单初始化数据的方法。
4. **Sign_up.vue**
   - Props:
     - `username`: 用户名。
     - `token`: 用于授权的令牌。
   - Events:
     - `ChangerRegisterMode`: 切换注册模式的方法。
5. **Personal_Center.vue**
   - Props:
     - `userdata`: 用户数据。
     - `HasLogin`: 用户是否登录的状态。
     - `username`: 用户名。
     - `token`: 用于授权的令牌。
   - Events:
     - `updateavatar`: 更新用户头像的方法。
6. **HomePage_Main.vue**
   - Props:
     - `songlist`: 单个歌单信息。
     - `needshowsonglistpage`: 控制是否需要显示歌单页面。
     - `SearchContent`: 搜索内容。
     - `ShowSearchView`: 控制是否显示搜索结果页面。
     - `songlistsearch`: 搜索得到的歌单列表。
     - `songlists`: 歌单列表。
     - `index`: 当前页面索引。
     - `username`: 用户名。
     - `userlike`: 用户喜欢的音乐列表。
     - `songlistlast`: 最新的歌单列表。
     - `HomePageRecommendLatest`: 首页推荐最新的歌曲列表。
     - `token`: 用于授权的令牌。
     - `SongListId`: 歌单ID。
     - `HotSongs`: 热门歌曲列表。
   - Events:
     - `handlePlayAfter`: 播放下一首音乐的方法。
     - `handlePlayNow`: 立即播放音乐的方法。
     - `refreshNewest_Songs_Page`: 刷新最新歌曲页面的方法。
     - `changesonglist`: 改变歌单的方法。
     - `PlaySongList`: 播放歌单的方法。
7. **ExplorePage_Main.vue**
   - Props:
     - `username`: 用户名。
     - `token`: 用于授权的令牌。
   - Events:
     - `handlePlayAfter`: 播放下一首音乐的方法。
     - `handlePlayNow`: 立即播放音乐的方法。
8. **SettingPage_Main.vue**
   - Props:
     - `token`: 用于授权的令牌。
9. **CreateCenterPage_Main.vue**
   - Props:
     - `userUploadedSongs`: 用户上传的歌曲列表。
     - `HasLogin`: 用户是否登录的状态。
     - `username`: 用户名。
     - `handlePlayAfter`: 播放下一首音乐的方法。
     - `token`: 用于授权的令牌。
   - Events:
     - `handlePlayNow`: 立即播放音乐的方法。
10. **CreatedSonglist_Main.vue**
    - Props:
      - `createdSonglists`: 用户创建的歌单列表。
      - `token`: 用于授权的令牌。
      - `username`: 用户名。
    - Events:
      - `PlaySongList`: 播放歌单的方法。
      - `handlePlayAfter`: 播放下一首音乐的方法。
      - `handlePlayNow`: 立即播放音乐的方法。
      - `PlayLikeSongs`: 播放用户喜欢的音乐列表。
11. **FavoriteSonglist_Main.vue**
    - Props:
      - `favoriteSonglists`: 用户收藏的歌单列表。
      - `createdSonglists`: 用户创建的歌单列表。
      - `token`: 用于授权的令牌。
      - `username`: 用户名。
    - Events:
      - `PlaySongList`: 播放歌单的方法。
      - `handlePlayAfter`: 播放下一首音乐的方法。
      - `handlePlayNow`: 立即播放音乐的方法。
12. **AdminPage_Main.vue**
    - Props:
      - `token`: 用于授权的令牌。
13. **MusicPlayer_Cell.vue**
    - Props:
      - `musicList`: 音乐列表。
      - `token`: 用于授权的令牌。
      - `mode`: 当前页面模式。
      - `HasLogin`: 用户是否登录的状态。
      - `datax`: 播放列表信息。
      - `username`: 用户名。
      - `cantransformtofull`: 控制是否能够全屏播放的状态。
    - Ref:
      - `MusicPlayer_Cell_Ref`: 组件的引用。
    - Events:
      - `handlePlayNow`: 立即播放音乐的方法。
      - `handlePlayAfter`: 播放下一首音乐的方法。

**首页组件调用（HomePage_Main）:**

1. **Search_View.vue**

- Props:
  - `songlistlast`: 上次的歌单列表。
  - `username`: 用户名。
  - `userlike`: 用户喜欢的歌曲列表。
  - `token`: 用于授权的令牌。
- Events:
  - `handlePlayNow`: 立即播放音乐的方法。
  - `handlePlayAfter`: 播放下一首音乐的方法。
  - `changesize`: 改变大小的方法。
  - `addToSongList`: 将歌曲添加到歌单的方法。

2. **CurrentUser_SongList.vue**

- Props:
  - `CurrentUser_SongListdata`: 当前用户的歌单数据。
  - `needtoaddSongid`: 需要添加的歌曲ID。
  - `token`: 用于授权的令牌。
- Events:
  - `CloseCurrentUser_SongList`: 关闭当前用户歌单列表的方法。

3. **SongList_Page.vue**

- Props:
  - `songlist`: 歌单列表。
  - `username`: 用户名。
  - `userlike`: 用户喜欢的歌曲列表。
  - `index`: 歌单索引。
  - `token`: 用于授权的令牌。
  - `SongListId`: 歌单ID。
- Events:
  - `changesize`: 改变大小的方法。
  - `handlePlayAfter`: 播放下一首音乐的方法。
  - `handlePlayNow`: 立即播放音乐的方法。
  - `addToSongList`: 将歌曲添加到歌单的方法。
  - `ChangeSongList`: 改变歌曲列表的方法。

4. **Newest_Songs_Page.vue**

- Props:
  - `songlistlast`: 上次的歌单列表。
  - `username`: 用户名。
  - `userlike`: 用户喜欢的歌曲列表。
  - `token`: 用于授权的令牌。
- Events:
  - `handlePlayNow`: 立即播放音乐的方法。
  - `handlePlayAfter`: 播放下一首音乐的方法。
  - `addToSongList`: 将歌曲添加到歌单的方法。

5. **SongPage.vue**

- Props:
  - `currentSongId`: 当前音乐的ID。
  - `username`: 用户名。
  - `token`: 用于授权的令牌。
- Events:
  - `handlePlayNow`: 立即播放音乐的方法。
  - `CloseSong`: 关闭音乐详情页的方法。

6. **Image_Scrool.vue**

- Props:
  - `songlists`: 歌曲列表。
  - `index`: 歌曲索引。
  - `token`: 用于授权的令牌。
- Events:
  - `changesonglist`: 改变歌曲列表的方法。

7. **SingerList_Scrool.vue**

- Props:
  - `songlists`: 歌曲列表。
  - `token`: 用于授权的令牌。

8. **Search.vue**

- Props:
  - `SearchContent`: 搜索内容。
  - `token`: 用于授权的令牌。
- Events:
  - `SearchOperation`: 执行搜索操作的方法。

9. **CurrentUser_SongList.vue**

- Props:
  - `CurrentUser_SongListdata`: 当前用户的歌单数据。
  - `needtoaddSongid`: 需要添加的歌曲ID。
  - `token`: 用于授权的令牌。
- Events:
  - `CloseCurrentUser_SongList`: 关闭当前用户的歌单的方法。

**管理员界面调用（AdminPage_Main）：**

1. **Admin_SongList_View.vue**

- Methods:
  - None
- Props:
  - `token`: 用于授权的令牌。
  - `SongLists`: 歌单列表数据。
  - `SearchContent`: 搜索内容。
- Events:
  - `refresh`: 刷新数据的事件。

2. **Admin_Song_View.vue**

- Methods:
  - None
- Props:
  - `token`: 用于授权的令牌。
  - `Songs`: 歌曲列表数据。
  - `SearchContent`: 搜索内容。
- Events:
  - `refresh`: 刷新数据的事件。

3. **Admin_User_View.vue**

- Methods:
  - None
- Props:
  - `token`: 用于授权的令牌。
  - `Users`: 用户列表数据。
  - `SearchContent`: 搜索内容。
- Events:
  - `refresh`: 刷新数据的事件。

4. **Admin_Search_Song_View.vue**

- Methods:
  - None
- Props:
  - `SearchContent`: 搜索内容。
  - `token`: 用于授权的令牌。
- Events:
  - `changesize`: 改变大小的事件。
  - `refresh`: 刷新数据的事件。
  - `UpdateSong`: 更新歌曲的事件。

5. **Admin_Search_Songlist_View.vue**

- Methods:
  - None
- Props:
  - `SearchContent`: 搜索内容。
  - `token`: 用于授权的令牌。
- Events:
  - `changesize`: 改变大小的事件。
  - `refresh`: 刷新数据的事件。
  - `UpdateSongList`: 更新歌单的事件。

6. **Admin_Search_User_View.vue**

- Methods:
  - None
- Props:
  - `SearchContent`: 搜索内容。
  - `token`: 用于授权的令牌。
- Events:
  - `changesize`: 改变大小的事件。
  - `refresh`: 刷新数据的事件。
  - `UpdateUser`: 更新用户的事件。

**探索界面（ExplorePage_Main）：**

1. **Singer_Show_Area.vue**
   - Methods:
     - `handlePlayAfter(index)`: 处理播放下一首歌曲的方法。
     - `handlePlayNow(index)`: 处理立即播放歌曲的方法。
   - Props:
     - `token`: 用于授权的令牌。
     - `username`: 用户名。
2. **List_Show_Area.vue**
   - Methods:
     - `handlePlayAfter(index)`: 处理播放下一首歌曲的方法。
     - `handlePlayNow(index)`: 处理立即播放歌曲的方法。
   - Props:
     - `token`: 用于授权的令牌。
     - `username`: 用户名。
3. **User_Show_Area.vue**
   - Methods:
     - `handlePlayAfter(index)`: 处理播放下一首歌曲的方法。
     - `handlePlayNow(index)`: 处理立即播放歌曲的方法。
     - `PlaySongList(id)`: 播放歌单的方法。
   - Props:
     - `token`: 用于授权的令牌。
     - `username`: 用户名。

**歌曲播放模块（MusicPlayer_Cell）：**

1. **MusicPlayerView.vue**
   - Methods:
     - `togglePlay`: 切换播放/暂停状态的方法。
     - `nextSong`: 播放下一首歌曲的方法。
     - `backSong`: 播放上一首歌曲的方法。
   - Props:
     - `name`: 当前播放歌曲的名称。
     - `singer`: 当前播放歌曲的歌手。
     - `cover`: 当前播放歌曲的封面图片。
     - `id`: 当前播放歌曲的ID。
     - `currentTime`: 当前播放时间。
     - `duration`: 歌曲总时长。
     - `isPlaying`: 播放状态。
     - `durationInSeconds`: 歌曲总时长（以秒为单位）。
     - `currentTimeInSeconds`: 当前播放时间（以秒为单位）。
     - `audioPlayer`: 音频播放器的引用。
     - `playerMode`: 播放模式。
     - `curIndex`: 当前播放歌曲的索引。
     - `token`: 用于授权的令牌。
     - `datax`: 播放列表信息。
   - Events:
     - `togglePlay`: 切换播放/暂停状态的事件。
2. **MusicPlayerFullView.vue**
   - Methods:
     - `togglePlay`: 切换播放/暂停状态的方法。
     - `nextSong`: 播放下一首歌曲的方法。
     - `backSong`: 播放上一首歌曲的方法。
   - Props:
     - `name`: 当前播放歌曲的名称。
     - `singer`: 当前播放歌曲的歌手。
     - `cover`: 当前播放歌曲的封面图片。
     - `id`: 当前播放歌曲的ID。
     - `username`: 用户名。
     - `lyric`: 歌词信息。
     - `sty`: 当前播放歌曲的渐变背景样式。
     - `currentTime`: 当前播放时间。
     - `duration`: 歌曲总时长。
     - `isPlaying`: 播放状态。
     - `durationInSeconds`: 歌曲总时长（以秒为单位）。
     - `currentTimeInSeconds`: 当前播放时间（以秒为单位）。
     - `audioPlayer`: 音频播放器的引用。
     - `token`: 用于授权的令牌。
   - Events:
     - `togglePlay`: 切换播放/暂停状态的事件。
     - `back`: 返回上一个播放状态的事件。
     - `next`: 播放下一首歌曲的事件。

**音乐全屏播放界面（MusicPlayerFullView）：**

1. **Warning.vue**

- Methods：
  - `closeWarning()`: 关闭警告框。
- Props：
  - `message`: 警告框中显示的消息。
  - `token`: 用于身份验证或识别用户的令牌。
  - `warningShow`: 控制警告框的显示状态。

2. **ButtonChangeSize.vue**

- Methods：
  - `changeSize()`: 改变按钮的大小。
- Props：
  - `token`: 用于身份验证或识别用户的令牌。

3. **Comment.vue**

- Props：
  - `token`: 用于身份验证或识别用户的令牌。
  - `id`: 评论的唯一标识符。
  - `showComment`: 控制评论显示的状态。
  - `songID`: 评论所属的歌曲的唯一标识符。
  - `warningShow`: 控制警告框的显示状态。
  - `message`: 评论框中显示的消息。
  - `username`: 用户的用户名。

4. **LyricsShowView.vue**

- Props：
  - `currentDuration`: 当前播放的音频的持续时间。
  - `lrcArr`: 包含歌词时间和文本的数组。
  - `audioPlayer`: 音频播放器实例。

**创建的歌单界面（CreatedSongList_Main）：**

1. **LikeSongs_Area.vue**
   - Methods（方法）：
     - `handlePlayAfter(index)`: 处理播放下一首歌曲的方法。
     - `handlePlayNow(index)`: 处理立即播放歌曲的方法。
     - `changesize()`: 改变大小的方法。
   - Props（属性）：
     - `LikeSongsCover`: 用户喜欢的歌曲封面。
     - `username`: 用户名。
     - `token`: 用于身份验证或识别用户的令牌。
2. **CreatedSonglist.vue**
   - Methods（方法）：
     - `PlaySongList(id)`: 播放歌单的方法。
     - `handlePlayAfter(id)`: 处理播放下一首歌曲的方法。
     - `handlePlayNow(id)`: 处理立即播放歌曲的方法。
     - `changesize()`: 改变大小的方法。
   - Props（属性）：
     - `currentSonglistId`: 当前选中的歌单 ID。
     - `token`: 用于身份验证或识别用户的令牌。
     - `username`: 用户名。

**喜爱的歌单界面（FavoriteSonglist_Main）:**

**Songlist.vue**

- **Methods:**
  - `PlaySongList(id)`: 播放歌单的方法。
  - `handlePlayAfter(id)`: 处理播放下一首歌曲的方法。
  - `handlePlayNow(id)`: 处理立即播放歌曲的方法。
  - `closeSonglist()`: 关闭歌单的方法。
- **Props:**
  - `currentSonglistId`: 当前选中的歌单 ID。
  - `token`: 用于身份验证或识别用户的令牌。
  - `username`: 用户名。

### 4.3 用户界面设计

**登录界面设计：**

<img src="软件详细设计说明书.assets/屏幕截图 2024-05-13 102725-1715567813668-2.png" alt="屏幕截图 2024-05-13 102725" style="zoom:50%;" />

**注册/忘记密码界面设计：**

<img src="软件详细设计说明书.assets/屏幕截图 2024-05-13 103346.png" alt="屏幕截图 2024-05-13 103346" style="zoom:50%;" />

**个人中心界面设计：**

<img src="软件详细设计说明书.assets/QQ截图20240513103927.png" alt="QQ截图20240513103927" style="zoom:50%;" />

**首页设计：**

**推荐部分上半部分**

![屏幕截图 2024-05-13 104613](软件详细设计说明书.assets/屏幕截图 2024-05-13 104613-1715569430266-14.png)

**推荐部分下半部分**

![屏幕截图 2024-05-13 104935](软件详细设计说明书.assets/屏幕截图 2024-05-13 104935.png)

**最新上传部分**

![屏幕截图 2024-05-13 105240](软件详细设计说明书.assets/屏幕截图 2024-05-13 105240.png)

**搜索界面**

![屏幕截图 2024-05-13 105434](软件详细设计说明书.assets/屏幕截图 2024-05-13 105434.png)

**探索界面设计：**

**歌曲探索界面**

![屏幕截图 2024-05-13 105644](软件详细设计说明书.assets/屏幕截图 2024-05-13 105644.png)

**歌单探索界面**

![屏幕截图 2024-05-13 110118](软件详细设计说明书.assets/屏幕截图 2024-05-13 110118-1715569385258-12.png)

**用户探索界面**

![屏幕截图 2024-05-13 110418](软件详细设计说明书.assets/屏幕截图 2024-05-13 110418.png)

**查看其他用户详情**

![屏幕截图 2024-05-13 110630](软件详细设计说明书.assets/屏幕截图 2024-05-13 110630.png)

**创作中心界面设计：**

**我的创作界面**

![屏幕截图 2024-05-13 110850](软件详细设计说明书.assets/屏幕截图 2024-05-13 110850.png)

**创作歌曲界面**

![图片](软件详细设计说明书.assets/图片.png)

**创建歌单界面**

![QQ截图20240513112329](软件详细设计说明书.assets/QQ截图20240513112329.png)

**创建的歌单界面设计：**

![屏幕截图 2024-05-13 112621](软件详细设计说明书.assets/屏幕截图 2024-05-13 112621.png)

歌单详情展示

![屏幕截图 2024-05-13 112823](软件详细设计说明书.assets/屏幕截图 2024-05-13 112823.png)

**收藏的歌单界面设计：**

![屏幕截图 2024-05-13 112956](软件详细设计说明书.assets/屏幕截图 2024-05-13 112956.png)

**歌曲全屏播放界面设计：**

![屏幕截图 2024-05-13 113129](软件详细设计说明书.assets/屏幕截图 2024-05-13 113129.png)

**评论展示**

![屏幕截图 2024-05-13 113332](软件详细设计说明书.assets/屏幕截图 2024-05-13 113332.png)

**管理员界面设计：**

![屏幕截图 2024-05-13 113516](软件详细设计说明书.assets/屏幕截图 2024-05-13 113516.png)

## 5 异常处理设计

### 5.1 出错信息管理

为了确保系统的健壮性和用户体验，应对各类错误和异常进行详细的记录与管理。这包括：

#### 5.1.1 日志记录

系统应记录所有关键操作的日志，特别是用户登录、上传歌曲、创建歌单等操作。日志应包含操作时间、操作者、操作类型以及操作结果。

#### 5.1.2 错误分类

系统中的错误应分为不同的类别，如用户输入错误、系统内部错误和第三方服务错误。为每一类错误定义标准错误代码和错误信息，方便问题的快速定位和处理。

#### 5.1.3 用户通知

在用户操作中出现错误时，应通过友好且明确的消息通知用户错误的性质和可能的解决方案。例如，如果用户试图上传一个不支持的文件格式，系统应提示“文件格式不支持，请上传mp3或wav格式的音频文件”。

### 5.2故障预防与补救

系统应具备故障预防和应急响应机制，这包括：

#### 5.2.1 输入验证

增强对用户输入的验证，确保输入数据的合法性和安全性。例如，检查上传文件的类型和大小，避免SQL注入等安全风险。

#### 5.2.2 资源限制

设置合理的资源使用限制，如单个用户的最大上传量、访问频率限制等，防止资源滥用导致服务不可用。

#### 5.2.3 备份与恢复

定期备份数据库和关键数据，确保在数据丢失或系统故障时能迅速恢复。

### 5.3 系统维护设计

建立系统维护的规范流程，这包括：

#### 5.3.1 定期检查

定期进行系统的性能和安全检查，及时发现并修复潜在的问题。

#### 5.3.2 更新和补丁

跟踪依赖库和框架的更新，及时应用安全补丁和更新，防止安全漏洞。

#### 5.3.3 性能监控

实施系统性能监控，通过监控工具跟踪系统的响应时间、资源使用情况等，及时调整系统配置或扩展资源。

## 6 性能优化和安全设计

### 6.1 性能优化

#### 6.1.1 数据库优化

使用索引优化数据库查询，特别是在用户表和歌曲表上。考虑使用缓存策略减轻数据库压力，如对频繁访问的歌曲信息和用户信息使用内存缓存。

#### 6.1.2 异步处理

对耗时操作（如歌曲上传、大数据量的数据处理）采用异步处理方式，提高系统响应速度。

#### 6.1.3 资源压缩与合并

对静态资源如CSS和JavaScript文件进行压缩与合并，减少HTTP请求的数量和大小。

### 6.2 安全设计

#### 6.2.1 数据加密

对敏感数据如用户密码和个人信息进行加密存储，使用HTTPS协议加密数据传输。

#### 6.2.2 访问控制

实施细粒度的访问控制策略，确保用户只能访问他们被授权的资源。

#### 6.2.3 防御措施

部署防火墙和入侵检测系统，防止DDoS攻击和其他网络攻击。定期进行安全审计和渗透测试，检测和修复潜在的安全漏洞。

## 7 项目测试计划


| 序号 | 测试类型 | 对应部分     | 测试内容                                                                                 | 计划测试时间 |
|----| -------- |----------|--------------------------------------------------------------------------------------|--------|
| 1  |单元测试| 登录注册模块   | 测试用户登录注册功能                                                                           | 5/11   |
| 2  |单元测试| 个人信息管理模块 | 测试用户查看和修改自己的个人信息功能                                                                   | 5/11   |
| 3  |单元测试| 歌曲播放模块   | 测试歌曲播放操作（继续播放和暂停播放、顺序播放、随机播放、单曲重复播放）、调节播放音量、调节播放进度、播放下一首歌曲、播放上一首歌曲、立即播放、添加歌曲到播放列表、播放歌单中所有歌曲 | 5/11   |
| 4  |单元测试| 歌曲管理模块   | 测试上传歌曲、管理自己上传的歌曲、对歌曲进行删除和修改、对歌曲进行标签分类、定制和导出歌词文件功能、收藏歌曲、对歌曲进行投诉                       | 5/18   |
| 5  |单元测试| 歌单管理模块   | 测试创建歌单、管理自己创建的歌单、对歌单进行删除和修改、为自己创建的歌单设置标签分类、添加歌曲到自己创建的歌单、收藏歌单、从歌单将歌曲批量导入收藏夹           | 5/18   |
| 6  |单元测试| 社交互动模块   | 测试用户之间的评论、点赞收藏歌曲、分享歌曲和歌单、消息接收和发送、接收更新歌曲和歌单的消息、定期给用户发送创作周报、查看其他用户的主页、关注其他用户           | 5/18   |
| 7  |单元测试| 搜索与推荐模块  | 测试歌曲和歌单推荐、检索（歌曲、歌单、歌手）、对歌曲的分类标签进行查找、创建听歌周报                                           | 5/18   |
| 8  |单元测试| 平台管理模块   | 测试投诉消息的接收和审查功能、管理端对平台用户进行管理                                                          | 5/18   |
| 9  |集成测试| 用户界面子系统  | 测试登录/注册模块、音乐播放器界面、音乐库界面、搜索界面、个性化推荐界面、设置界面、探索界面                                       | 5/25   |
| 10 |集成测试| 音乐管理子系统  | 测试音乐信息管理、播放列表管理、音乐文件管理                                                               | 5/25   |
| 11 |集成测试| 推荐子系统    | 测试数据分析模块、推荐算法模块                                                                      | 5/25   |
| 12 |集成测试| 安全与备份子系统 | 测试用户认证、数据加密                                                                          | 5/25   |
| 13 |集成测试| 交互子系统    | 测试消息管理、评论管理、关注列表管理、投诉管理                                                              | 5/25   |
| 14 |系统测试| 音乐分享平台   | 测试平台是否能正常运行                                                                          | 6/1    |
